优先级与排期

- 维度：P0（必须，本周）、P1（应做，下周/本月）、P2（可做，本季度）
- 标签建议： area:cms 、 area:web 、 area:seo 、 area:security 、 area:ops 、 perf 、 bug 、 feature
P0 · 本周处理

- 加固内部接口鉴权（ /internal/* ）
  - 变更范围： blogs-cms/src/api/internal/routes/internal.ts 、 controllers/internal.ts 、 config/server.ts
  - 动作：用服务端密钥（ INTERNAL_ADMIN_TOKEN ）校验 x-admin-token ；可选加入 IP 白名单；保留 CLI 能力
  - 交付标准：未携带/错误 token 返回 401；CLI scripts/auto-tag.js 能携带 token 正常调用
  - 估时：0.5 天；依赖：环境变量注入
- 评论黑白名单与来源校验
  - 变更范围： blogs-cms/src/api/comment/content-types/comment/lifecycles.ts 、 config/plugins.ts 或自定义 config
  - 动作：在 beforeCreate 校验关键词黑/白名单、站点/文章黑名单、 authorLink 域名白名单；长度/URL 格式限制
  - 交付标准：命中黑名单拒绝；白名单绕过；合法来源入库且 status=pending
  - 估时：1 天；依赖：规则来源（env 或配置文件，如 G:\code\blogs\tag-rules.json ）
- 评论频率限制（站点/文章维度）
  - 变更范围： blogs-cms/src/api/comment/... 控制器或服务层；必要时新增轻量计数服务
  - 动作：查询当天计数（按站点/文章），超过阈值拒绝；与现有 IP 速率限制互补
  - 交付标准：达到上限返回 429；日志包含拒绝原因
  - 估时：0.5 天；依赖：阈值配置（env）
- 修复首页 searchParams 类型误用
  - 变更范围： blogs-web/src/app/page.tsx
  - 动作：将签名从 Promise<any> 改为 Next 约定对象类型，移除 await
  - 交付标准：编译通过；搜索与分页行为不变
  - 估时：0.2 天；标签： bug , area:web
- 详情页改为 ISR（提升吞吐）
  - 变更范围： blogs-web/src/app/[slug]/page.tsx
  - 动作：设置 export const revalidate = 300~1800 （结合内容更新频率），保留热点页 SSR 的空间
  - 交付标准：静态化生效；更新后在 revalidate 时间窗内再生；TTFB 降低
  - 估时：0.5 天；依赖：CMS 变更频率评估
- 增加安全响应头（替换废弃 X-XSS-Protection）
  - 变更范围： blogs-web/next.config.ts
  - 动作：添加 Content-Security-Policy 、 Referrer-Policy 、 Permissions-Policy 、 Strict-Transport-Security （HTTPS）
  - 交付标准：响应头正确下发；不影响现有资源加载
  - 估时：0.5 天；依赖：域名/CDN 情况
P1 · 下周/本月

- 站内 SEO：结构化数据与 canonical
  - 变更范围： blogs-web/src/app/[slug]/page.tsx 、 src/app/t/[slug]/page.tsx
  - 动作： generateMetadata 增加 Article JSON-LD、Open Graph；完善 canonical；标签页描述
  - 交付标准：页面含 JSON-LD；SEO 检查通过（Google/Baidu 结构化）
  - 估时：1 天；标签： area:seo
- sitemap.xml 与 robots.txt 生成
  - 变更范围： blogs-web/src/app/sitemap.ts 或 src/app/sitemap.xml/route.ts 、 public/robots.txt 或动态路由
  - 动作：按站点与文章生成；每日更新；支持增量
  - 交付标准：含全部有效 URL；搜索引擎工具可读取
  - 估时：1 天；依赖：站点域名与文章量
- 百度主动推送接口与任务（只有填写了 BAIDU_SITE 与 BAIDU_TOKEN 才会生效）
  - 变更范围： blogs-web/src/app/api/baidu/push/route.ts 、 blogs-cms/src/bootstrap.ts 或 lib/cron.ts
  - 动作：新增推送 API，结合发布/定时任务推送新增 URL；配置 BAIDU_SITE 、 BAIDU_TOKEN
  - 交付标准：推送成功日志；失败重试；可在管理端查看统计
  - 估时：1.5 天；标签： area:ops , area:seo
- 内链优化（权重与停用词）
  - 变更范围： blogs-web/src/lib/internal-links.ts
  - 动作：加入停用词与权重策略；避免过度链出；排除标题完全匹配的自链
  - 交付标准：内链数量与质量可控；无明显过度优化
  - 估时：0.5 天；依赖：词库（可复用 tag-rules.json ）
- CMS 索引与查询优化
  - 变更范围： blogs-cms/database/migrations/ （新增索引迁移）
  - 动作：为 article.slug 、 tag.slug 、 site.domain 增加索引；检查常见查询
  - 交付标准：列表/详情查询耗时下降；无迁移风险
  - 估时：1 天；标签： perf , area:cms
- 任务编排与审计
  - 变更范围： blogs-cms/src/lib/cron.ts （新增）及配置；记录任务运行日志实体
  - 动作：定时 autoTag 、百度推送；保存运行结果与统计
  - 交付标准：任务按计划运行；日志可检索
  - 估时：1 天；依赖：基础安全完成
P2 · 本季度

- 评论管理后台开关与策略配置 UI
  - 变更范围：Strapi Admin（自定义插件或内容类型配置面板）
  - 动作：审核开关、黑白名单、阈值、来源域名白名单可视化
  - 交付标准：运营可配置且持久化；权限受控
  - 估时：3 天；标签： feature , area:cms
- 模板系统增强与多主题支持
  - 变更范围： blogs-web/src/lib/template.ts 、 app/admin/sites/page.tsx
  - 动作：主题化参数扩展、布局切换、站点级个性化
  - 交付标准：多站点多主题可运行；不影响 SEO
  - 估时：3 天；标签： feature , area:web
- 内容采集/AI 生成工作流完善
  - 动作：完善 aiGenerate 参数与质量控制、审计日志；接入外部内容源清洗
  - 交付标准：可控质量与节奏；无版权风险
  - 估时：5 天；标签： area:ops , feature
依赖与里程碑

- 里程碑 M1（本周）：完成 P0；基础安全、评论风控、ISR 与关键修复
- 里程碑 M2（本月）：完成 P1；SEO 基建、推送与任务编排、性能与内链优化
- 里程碑 M3（本季度）：完成 P2；运营化与模板多样化、生成工作流增强
落地建议

- Issue 命名规范
  - 格式示例： [P0][area:cms] 加固 /internal 接口鉴权（x-admin-token -> env 密钥）
  - 每个 Issue 写清：变更范围（文件路径）、动作步骤、交付标准、依赖、估时
- 执行顺序
  - 先安全（P0）→ 再 SEO/任务（P1）→ 后运营化（P2）
- 我可以继续：为上述每一项创建详细 Issue 内容（标题、描述、检查清单、验收标准），并在你的项目管理工具中按里程碑分组。如果你告诉我使用的平台（如 GitHub Issues/Jira）与模板，我将直接批量生成。