# 博客站群需求文档 (Next.js + Strapi)

版本：v1.0  
更新日期：2025-10-17

## 1. 项目目标
- 搭建一个高性能、SEO 友好（重点面向百度）的内容型博客站群。  
- 支持 AI 生成或采集内容，无需付费订阅、无需作者协作。  
- 全站支持用户评论，并实现跨站评论：从其他站点随机取文章标题作为用户名并生成带 a 标签的链接插入评论内容。  
- 功能保持简洁，但具备可扩展性（站群扩展、功能扩展、性能扩展）。

## 2. 范围与定位
- 范围：内容管理、文章展示、评论系统、站群管理、SEO优化、基础运营。  
- 定位：内容分发站群，主打搜索引擎流量获取（百度），后续可扩展到其他搜索引擎与渠道。

## 3. 用户与角色
- 游客：浏览文章、查看评论、提交评论。  
- 管理员（运营）：在后台（Strapi）管理站点、文章、评论、分类与标签，控制跨站评论频率与策略。  
- 系统（任务脚本/定时器）：负责内容采集/生成、主动推送链接到百度、跨站评论任务。

## 4. 内容来源策略
- AI 生成：通过内部工具或外部辅助生成文章内容，录入 Strapi。  
- 采集：从允许采集的来源抓取并清洗内容（确保合法合规，避免版权风险）。  
- 不要求作者协作与付费订阅。

## 5. 站群与评论策略
- 站群：多个前端站点（不同域名）共享一个 Strapi 后端与数据库；文章归属到具体站点。  
- 跨站评论：
  - 从其他站点随机选一篇文章作为“评论来源”。  
  - 用该文章的标题作为 `authorName`（用户名），文章链接作为 `authorLink`（a 标签），摘要/首段作为评论内容。  
  - 设置频率与上限（如每站每日最多 N 条，每篇文章下最多插入五条评论），避免垃圾评论与过度互链。  
  - 支持审核开关与黑白名单（站点、文章、关键词）。

## 6. 核心功能需求
- 文章：列表、详情、分类/标签、分页、相关推荐、站点归属。  
- 评论：展示、提交、审核（可选）、反垃圾、跨站自动评论。  
- 站群：站点信息管理（名称、域名、主题色等），按站点聚合与筛选数据。  
- SEO：SSR/SSG、唯一 `slug`、`<title>`、`<meta name="description">`、`canonical`、`sitemap.xml`、`robots.txt`、结构化数据（Article JSON-LD）、百度主动推送。  
- 运维：基础统计（PV/UV）、错误日志、可观测性（最低限度）。

## 7. 非功能性需求
- SEO（百度）：
  - 页面可预渲染（SSR/SSG），首屏 HTML 完整可抓取。  
  - 自动生成 `sitemap.xml` 与 `robots.txt`，支持主动链接推送到百度。  
  - 规范 URL 结构与 canonical，消除重复收录。  
- 性能：
  - 目标指标：LCP < 2.5s（4G 网络），TTFB(SSR) < 500ms，CLS ~ 0。  
  - 使用静态资源优化、图片懒加载、CDN 缓存、ISR（增量静态再生）。  
- 安全：
  - 表单与评论的输入校验与 XSS 防护（HTML 清洗/白名单）。  
  - 速率限制与防刷机制，API Token 管控。  
- 可扩展性：
  - 数据模型可扩展（站点、分类、标签、作者），功能模块插件化（采集、推送、评论策略）。  
- 易用性：
  - 后台录入便捷，前端阅读体验良好，移动端友好。

## 8. 数据模型（概要）
- Site（站点）：`name`、`domain`、`enabled`、`theme`。  
- Article（文章）：`title`、`slug`、`summary`、`content`、`site`(关系)、`tags`、`categories`、`publishedAt`。  
- Comment（评论）：`content`、`authorName`、`authorLink`、`article`(关系)、`sourceSite`(关系，可选)、`status`(enum: approved/pending/spam)。  
- Tag/Category（标签/分类）：基础层次与关联。  
- 可选：Author（作者），用于归档与展示（非必需）。

## 9. 权限与访问控制
- 公共 API：文章列表与详情只读，评论提交受限（校验与速率限制）。  
- 管理后台：管理员登录后管理所有数据与策略。  
- 部署级安全：限制后台访问来源、开启 HTTPS、日志审计。

## 10. 部署与环境
- 后端：Strapi（Node.js），开发用 SQLite，生产建议 PostgreSQL/MySQL。  
- 前端：Next.js，SSG+ISR（可选 SSR），CDN 分发静态资源。  
- 多站部署：多个域名指向不同的前端实例或同一前端配置；均连到同一 Strapi 后端。

## 11. 验收标准与 KPI
- 收录与流量：
  - 新内容 30 天内百度收录率 ≥ 70%。  
  - 核心关键词自然流量稳定增长。  
- 性能：核心页面 LCP < 2.5s、TTFB(SSR) < 500ms。  
- 稳定性：错误率低于 1%，评论反垃圾有效。  
- 运营：后台可用性与任务自动化（推送/评论）稳定运行。

## 12. 假设与约束
- 不依赖付费订阅与外部作者协作；内容由内部生成或采集。  
- 需遵守法律法规与版权要求。  
- 预算有限但可使用免费服务（如部分 CDN/静态托管）。

## 13. 风险与应对
- SEO 风险：内容质量与重复度不足 → 加强选题与去重。  
- 采集风险：版权与合法性 → 建立白名单来源与署名策略。  
- 评论风险：过度互链被判低质 → 严格频控、启用审核、添加 `rel="nofollow"`。  
- 性能风险：首屏慢 → 采用 SSG/ISR、图片优化与缓存策略。

---
本文档作为实施与评审依据，后续迭代可补充更细分的规则与度量。